{% extends "base.html" %}

{% block styles %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='css/help.css') }}">
<style>
    .help-toc {
        position: sticky;
        top: 20px;
    }
    .help-toc a {
        text-decoration: none;
    }
    .help-toc a:hover {
        color: var(--bs-primary);
    }

    /* Enhanced help content styling */
    .help-content h1 {
        border-bottom: 3px solid var(--bs-primary);
        padding-bottom: 0.75rem;
        margin-bottom: 2rem;
        font-size: 2.5rem;
    }

    .help-content h2 {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        padding: 1rem 1.5rem;
        border-left: 4px solid var(--bs-primary);
        margin-top: 3rem;
        margin-bottom: 1.5rem;
        border-radius: 0.375rem;
        font-size: 1.75rem;
        color: var(--bs-dark);
    }

    .help-content h3 {
        color: var(--bs-primary);
        margin-top: 2rem;
        margin-bottom: 1rem;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid #e9ecef;
        font-size: 1.5rem;
    }

    .help-content h4 {
        color: var(--bs-secondary);
        margin-top: 1.5rem;
        margin-bottom: 0.75rem;
        font-size: 1.25rem;
        font-weight: 600;
    }

    .help-content table {
        margin: 1.5rem 0;
        box-shadow: 0 0.125rem 0.25rem rgba(0,0,0,0.075);
    }

    .help-content table thead {
        background: var(--bs-primary);
        color: white;
    }

    .help-content blockquote {
        background: #f8f9fa;
        border-left: 4px solid var(--bs-info);
        padding: 1rem 1.5rem;
        margin: 1.5rem 0;
        border-radius: 0.375rem;
        color: var(--bs-dark);
    }

    .help-content code {
        background: #f8f9fa;
        padding: 0.2rem 0.4rem;
        border-radius: 0.25rem;
        font-size: 0.875em;
        color: #e83e8c;
    }

    .help-content pre {
        background: #282c34;
        color: #abb2bf;
        padding: 1.5rem;
        border-radius: 0.5rem;
        margin: 1.5rem 0;
        box-shadow: 0 0.25rem 0.5rem rgba(0,0,0,0.15);
    }

    .help-content pre code {
        background: transparent;
        color: inherit;
        padding: 0;
    }

    .help-content ul, .help-content ol {
        margin: 1rem 0;
        padding-left: 2rem;
    }

    .help-content li {
        margin: 0.5rem 0;
        line-height: 1.6;
    }

    .help-content p {
        line-height: 1.7;
        margin-bottom: 1rem;
    }

    .help-content strong {
        color: var(--bs-dark);
        font-weight: 600;
    }

    .help-content img {
        max-width: 100%;
        height: auto;
        border-radius: 0.5rem;
        box-shadow: 0 0.25rem 0.5rem rgba(0,0,0,0.1);
        margin: 1.5rem 0;
    }

    /* Info/Tip/Warning boxes */
    .help-content p:has(strong:first-child) {
        background: #d1ecf1;
        border-left: 4px solid #0c5460;
        padding: 1rem 1.5rem;
        border-radius: 0.375rem;
        margin: 1.5rem 0;
        color: #0c5460;
    }

    .help-content p:has(strong:first-child) strong {
        color: #0c5460;
    }
</style>
{% endblock %}

{% block content %}
<div class="container py-4">
    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb" class="mb-3">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{{ url_for('help.index') }}">Help Center</a></li>
            <li class="breadcrumb-item active" aria-current="page">{{ title }}</li>
        </ol>
    </nav>

    <div class="row">
        <!-- Main Content -->
        <div class="col-lg-9">
            <div class="card shadow-sm border-0 mb-4">
                <div class="card-body p-4 p-md-5">
                    <article class="help-content">
                        {{ content|safe }}
                    </article>
                </div>
            </div>

            <!-- Related Topics -->
            {% if related %}
            <div class="card shadow-sm border-0 mb-4">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="bi bi-link-45deg me-2"></i>Related Topics</h5>
                </div>
                <div class="card-body">
                    <div class="row g-3">
                        {% for rel_topic in related %}
                        <div class="col-md-4">
                            <a href="{{ url_for('help.topic', topic=rel_topic.slug) }}" class="card text-decoration-none h-100 border-primary">
                                <div class="card-body">
                                    <h6 class="card-title text-primary"><i class="bi bi-book me-1"></i>{{ rel_topic.title }}</h6>
                                    <p class="card-text text-muted small">Learn more <i class="bi bi-arrow-right"></i></p>
                                </div>
                            </a>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- Feedback -->
            <div class="card shadow-sm border-0 bg-light">
                <div class="card-body">
                    <p class="mb-0 text-muted">
                        <i class="bi bi-chat-left-text me-2"></i>
                        <strong>Was this helpful?</strong> If you have feedback or need additional help, please contact your administrator.
                    </p>
                </div>
            </div>
        </div>

        <!-- Sidebar with TOC -->
        <div class="col-lg-3">
            {% if toc %}
            <div class="help-toc">
                <div class="card shadow-sm border-0">
                    <div class="card-header bg-primary text-white">
                        <h6 class="mb-0"><i class="bi bi-list-ul me-2"></i>On This Page</h6>
                    </div>
                    <div class="card-body">
                        {{ toc|safe }}
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
